<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Self-Adaptive Cloud Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0a0e27;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1729 100%);
            min-height: 100vh;
            color: #e0e6ed;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 2;
        }
        
        header {
            margin-bottom: 50px;
            text-align: center;
        }
        
        h1 {
            font-size: 3.5em;
            font-weight: 800;
            background: linear-gradient(135deg, #63f8f8 0%, #8b5cf6 50%, #ec4899 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            letter-spacing: -0.02em;
        }
        
        header p {
            font-size: 1.1em;
            color: #a0aec0;
            font-weight: 300;
        }
        
        .status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 40px;
        }
        
        .status-item {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .status-item:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(99, 102, 241, 0.5);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
        }
        
        .status-label {
            font-size: 0.9em;
            color: #a0aec0;
            font-weight: 500;
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
            width: fit-content;
        }
        
        .status-ok { 
            background: rgba(16, 185, 129, 0.2);
            color: #6ee7b7;
            border: 1px solid rgba(16, 185, 129, 0.5);
        }
        
        .status-loading { 
            background: rgba(245, 158, 11, 0.2);
            color: #fcd34d;
            border: 1px solid rgba(245, 158, 11, 0.5);
        }
        
        .status-error { 
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            border: 1px solid rgba(239, 68, 68, 0.5);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
            pointer-events: none;
        }
        
        .card:hover {
            transform: translateY(-8px);
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(99, 102, 241, 0.5);
            box-shadow: 0 25px 50px rgba(99, 102, 241, 0.2), 
                        0 0 40px rgba(99, 102, 241, 0.1);
        }
        
        .card:hover::before {
            opacity: 1;
        }
        
        .card h3 {
            color: #63f8f8;
            margin-bottom: 25px;
            font-size: 1.3em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            color: #a0aec0;
            font-weight: 500;
            font-size: 0.95em;
        }
        
        .metric-value {
            font-size: 1.6em;
            font-weight: 700;
            background: linear-gradient(135deg, #63f8f8, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            height: 6px;
            margin-top: 8px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #63f8f8, #8b5cf6);
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.6);
        }
        
        .health-gauge {
            text-align: center;
            padding: 20px 0;
        }
        
        .gauge-circle {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            background: conic-gradient(
                to right, 
                #ef4444 0%, 
                #f59e0b 25%, 
                #fbbf24 50%, 
                #10b981 75%, 
                #10b981 100%
            );
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            position: relative;
            box-shadow: 0 0 40px rgba(99, 102, 241, 0.3);
        }
        
        .gauge-inner {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: #0a0e27;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            border: 2px solid rgba(99, 102, 241, 0.3);
        }
        
        .gauge-value {
            font-size: 2.2em;
            font-weight: 800;
            color: #63f8f8;
        }
        
        .gauge-label {
            font-size: 0.85em;
            color: #a0aec0;
            margin-top: 5px;
        }
        
        .anomaly-list {
            max-height: 200px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .anomaly-item {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid #ef4444;
            padding: 10px 12px;
            margin: 8px 0;
            border-radius: 8px;
            font-size: 0.9em;
            color: #fca5a5;
        }
        
        .api-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 35px;
            margin-top: 40px;
            transition: all 0.4s ease;
        }
        
        .api-section:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .api-section h2 {
            color: #63f8f8;
            margin-bottom: 15px;
            font-size: 1.8em;
            font-weight: 700;
        }
        
        .api-section p {
            color: #a0aec0;
            margin-bottom: 25px;
            font-weight: 300;
        }
        
        .api-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .api-link {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
            border: 1px solid rgba(99, 102, 241, 0.5);
            color: #e0e6ed;
            padding: 25px;
            border-radius: 15px;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            gap: 15px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .api-link:hover {
            transform: translateY(-6px);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.3), rgba(139, 92, 246, 0.3));
            border-color: #63f8f8;
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.3);
        }
        
        .api-icon {
            font-size: 2.5em;
        }
        
        .api-info h4 {
            margin-bottom: 8px;
            color: #63f8f8;
            font-weight: 600;
        }
        
        .api-info p {
            font-size: 0.9em;
            color: #a0aec0;
            margin-bottom: 0;
        }
        
        .endpoints-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .endpoint-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 18px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .endpoint-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .endpoint-card code {
            color: #63f8f8;
            font-weight: 600;
            font-size: 0.9em;
            word-break: break-all;
            font-family: 'Monaco', 'Courier New', monospace;
        }
        
        .endpoint-card p {
            color: #a0aec0;
            font-size: 0.9em;
            margin-top: 8px;
        }
        
        .alert {
            background: rgba(255, 255, 255, 0.05);
            border-left: 5px solid #63f8f8;
            border: 1px solid rgba(99, 102, 241, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            color: #e0e6ed;
            font-size: 0.95em;
        }
        
        .alert-info {
            border-left-color: #3b82f6;
        }
        
        .alert-success {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.05);
        }
        
        .alert a {
            color: #63f8f8;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        
        .alert a:hover {
            color: #8b5cf6;
        }
        
        /* Scrollbar styling */
        .anomaly-list::-webkit-scrollbar {
            width: 6px;
        }
        
        .anomaly-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .anomaly-list::-webkit-scrollbar-thumb {
            background: rgba(99, 102, 241, 0.5);
            border-radius: 10px;
        }
        
        .anomaly-list::-webkit-scrollbar-thumb:hover {
            background: rgba(99, 102, 241, 0.8);
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .card {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        .card:nth-child(1) { animation-delay: 0.1s; }
        .card:nth-child(2) { animation-delay: 0.2s; }
        .card:nth-child(3) { animation-delay: 0.3s; }
        .card:nth-child(4) { animation-delay: 0.4s; }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2em;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .status {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚ö° Self-Adaptive Cloud</h1>
            <p>Enterprise Infrastructure Monitoring & ML-Powered Anomaly Detection</p>
        </header>
        
        <div class="alert alert-info">
            <strong>üöÄ System Status:</strong> Real-time data flowing from backend API. Dashboard updates every 5 seconds with live metrics.
        </div>
        
        <div class="status">
            <div class="status-item">
                <span class="status-label">Backend API</span>
                <div class="status-badge status-loading">
                    <span>‚è≥</span> Checking...
                </div>
            </div>
            <div class="status-item">
                <span class="status-label">Integration Module</span>
                <div class="status-badge status-loading">
                    <span>‚è≥</span> Checking...
                </div>
            </div>
            <div class="status-item">
                <span class="status-label">Data Pipeline</span>
                <div class="status-badge status-loading">
                    <span>‚è≥</span> Checking...
                </div>
            </div>
            <div class="status-item">
                <span class="status-label">System Health</span>
                <div class="status-badge status-loading">
                    <span>‚è≥</span> Checking...
                </div>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="card">
                <h3>üìä System Metrics</h3>
                <div id="metrics-container">
                    <div class="metric">
                        <span class="metric-label">CPU Usage</span>
                        <span class="metric-value" id="cpu">--</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" id="cpu-bar" style="width: 0%"></div>
                    </div>
                    <div class="metric" style="margin-top: 20px;">
                        <span class="metric-label">Memory Usage</span>
                        <span class="metric-value" id="memory">--</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" id="memory-bar" style="width: 0%"></div>
                    </div>
                    <div class="metric" style="margin-top: 20px;">
                        <span class="metric-label">Disk Usage</span>
                        <span class="metric-value" id="disk">--</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" id="disk-bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>üéØ System Health</h3>
                <div class="health-gauge">
                    <div class="gauge-circle">
                        <div class="gauge-inner">
                            <div class="gauge-value" id="health-score">--</div>
                            <div class="gauge-label">Score</div>
                        </div>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Status</span>
                        <span class="metric-value" id="health-status">--</span>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>‚ö†Ô∏è Anomaly Detection</h3>
                <div class="metric">
                    <span class="metric-label">Total Detected</span>
                    <span class="metric-value" id="anomalies-count">0</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Detection Rate</span>
                    <span class="metric-value" id="anomalies-rate">0%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Last Activity</span>
                    <span class="metric-value" id="anomalies-recent">--</span>
                </div>
                <div id="anomaly-list" class="anomaly-list" style="margin-top: 15px;"></div>
            </div>
            
            <div class="card">
                <h3>üîó Integration Status</h3>
                <div class="metric">
                    <span class="metric-label">API Connection</span>
                    <span id="integration-check" style="color: #a0aec0;">Checking...</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Data Files</span>
                    <span id="data-files" style="color: #a0aec0;">Checking...</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Active Endpoints</span>
                    <span id="api-endpoints" style="color: #a0aec0;">Checking...</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Last Update</span>
                    <span id="last-update" style="color: #a0aec0;">--</span>
                </div>
            </div>
        </div>
        
        <div class="api-section">
            <h2>üì° API & Integration</h2>
            <p>Access comprehensive REST endpoints for system monitoring, anomaly detection, and real-time decision making.</p>
            
            <div class="api-links">
                <a href="http://localhost:8000/docs" target="_blank" class="api-link">
                    <div class="api-icon">üìö</div>
                    <div class="api-info">
                        <h4>Interactive API Docs</h4>
                        <p>Swagger UI - Try all endpoints</p>
                    </div>
                </a>
                <a href="http://localhost:8000/redoc" target="_blank" class="api-link">
                    <div class="api-icon">üìñ</div>
                    <div class="api-info">
                        <h4>API Reference</h4>
                        <p>ReDoc - Complete documentation</p>
                    </div>
                </a>
                <a href="http://localhost:8000/api/health/system-summary" target="_blank" class="api-link">
                    <div class="api-icon">‚öôÔ∏è</div>
                    <div class="api-info">
                        <h4>System Summary API</h4>
                        <p>JSON data endpoint</p>
                    </div>
                </a>
            </div>
            
            <h3 style="color: #63f8f8; margin-top: 30px; margin-bottom: 20px; font-size: 1.3em;">Key Integration Endpoints</h3>
            <div class="endpoints-grid">
                <div class="endpoint-card">
                    <code>GET /api/health/system-summary</code>
                    <p>Complete system overview with metrics, anomalies, and decisions</p>
                </div>
                <div class="endpoint-card">
                    <code>GET /api/health/integrated-status</code>
                    <p>Combined health score and system status assessment</p>
                </div>
                <div class="endpoint-card">
                    <code>GET /api/health/data-availability</code>
                    <p>Integration status and available data files</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Format time ago
        function timeAgo(timestamp) {
            const now = new Date();
            const date = new Date(timestamp);
            const seconds = Math.floor((now - date) / 1000);
            
            if (seconds < 60) return 'just now';
            if (seconds < 3600) return Math.floor(seconds / 60) + 'm ago';
            if (seconds < 86400) return Math.floor(seconds / 3600) + 'h ago';
            return Math.floor(seconds / 86400) + 'd ago';
        }
        
        // Update status badges
        function updateStatusBadges(isOnline, apiWorking, dataAvailable) {
            const statuses = document.querySelectorAll('.status-item');
            
            if (statuses[0]) {
                const badge = statuses[0].querySelector('.status-badge');
                badge.className = 'status-badge ' + (apiWorking ? 'status-ok' : 'status-error');
                badge.innerHTML = (apiWorking ? '‚úÖ' : '‚ùå') + ' ' + (apiWorking ? 'Online' : 'Offline');
            }
            
            if (statuses[1]) {
                const badge = statuses[1].querySelector('.status-badge');
                badge.className = 'status-badge ' + (apiWorking ? 'status-ok' : 'status-error');
                badge.innerHTML = (apiWorking ? '‚úÖ' : '‚ùå') + ' ' + (apiWorking ? 'Connected' : 'Error');
            }
            
            if (statuses[2]) {
                const badge = statuses[2].querySelector('.status-badge');
                badge.className = 'status-badge ' + (dataAvailable ? 'status-ok' : 'status-error');
                badge.innerHTML = (dataAvailable ? '‚úÖ' : '‚ùå') + ' ' + (dataAvailable ? 'Available' : 'Offline');
            }
            
            if (statuses[3]) {
                const badge = statuses[3].querySelector('.status-badge');
                badge.className = 'status-badge ' + (apiWorking ? 'status-ok' : 'status-error');
                badge.innerHTML = (apiWorking ? '‚úÖ' : '‚ùå') + ' ' + (apiWorking ? 'Healthy' : 'Check API');
            }
        }
        
        // Fetch and display system data
        async function loadSystemData() {
            try {
                // Fetch system summary
                const summaryResponse = await fetch('http://localhost:8000/api/health/system-summary');
                const summary = await summaryResponse.json();
                
                // Update metrics
                if (summary.metrics && summary.metrics.latest) {
                    const latest = summary.metrics.latest;
                    const cpu = latest.cpu_percent || 0;
                    const memory = latest.memory_percent || 0;
                    const disk = latest.disk_percent || 0;
                    
                    document.getElementById('cpu').textContent = cpu.toFixed(1) + '%';
                    document.getElementById('cpu-bar').style.width = Math.min(cpu, 100) + '%';
                    document.getElementById('memory').textContent = memory.toFixed(1) + '%';
                    document.getElementById('memory-bar').style.width = Math.min(memory, 100) + '%';
                    document.getElementById('disk').textContent = disk.toFixed(1) + '%';
                    document.getElementById('disk-bar').style.width = Math.min(disk, 100) + '%';
                }
                
                // Fetch health status
                const healthResponse = await fetch('http://localhost:8000/api/health/integrated-status');
                const health = await healthResponse.json();
                
                if (health.health_score !== undefined) {
                    document.getElementById('health-score').textContent = health.health_score.toFixed(1);
                    document.getElementById('health-status').textContent = health.status.toUpperCase();
                    
                    const statusColor = health.health_score >= 80 ? '#6ee7b7' : 
                                       health.health_score >= 50 ? '#fcd34d' : '#fca5a5';
                    document.getElementById('health-score').style.color = statusColor;
                    document.getElementById('health-status').style.color = statusColor;
                }
                
                // Update anomalies
                if (summary.anomalies) {
                    document.getElementById('anomalies-count').textContent = summary.anomalies.total_detected || 0;
                    const rate = (summary.anomalies.detection_rate * 100).toFixed(1);
                    document.getElementById('anomalies-rate').textContent = rate + '%';
                    
                    const recentCount = summary.anomalies.recent?.length || 0;
                    if (recentCount > 0) {
                        document.getElementById('anomalies-recent').textContent = recentCount + ' recent';
                        
                        // Update anomaly list
                        const anomalyList = document.getElementById('anomaly-list');
                        anomalyList.innerHTML = summary.anomalies.recent.slice(0, 3).map((anomaly, idx) => `
                            <div class="anomaly-item">
                                <strong>#${idx + 1}:</strong> ${anomaly.feature || 'System'} - Severity: ${anomaly.severity || 'Medium'}
                            </div>
                        `).join('');
                    } else {
                        document.getElementById('anomalies-recent').textContent = '‚úÖ None';
                        document.getElementById('anomaly-list').innerHTML = '<div class="anomaly-item" style="background: rgba(16, 185, 129, 0.1); border-left-color: #10b981; color: #6ee7b7;">‚úì No anomalies detected</div>';
                    }
                }
                
                // Fetch integration status
                const intResponse = await fetch('http://localhost:8000/api/health/data-availability');
                const intData = await intResponse.json();
                
                const isConnected = intData.status === 'connected';
                document.getElementById('integration-check').textContent = isConnected ? '‚úÖ Connected' : '‚ö†Ô∏è ' + intData.status;
                document.getElementById('integration-check').style.color = isConnected ? '#6ee7b7' : '#fca5a5';
                
                document.getElementById('data-files').textContent = 
                    (intData.data_available?.metrics ? '‚úÖ Loaded' : '‚ùå None');
                document.getElementById('data-files').style.color = 
                    (intData.data_available?.metrics ? '#6ee7b7' : '#fca5a5');
                
                document.getElementById('api-endpoints').textContent = '‚úÖ 11 Active';
                document.getElementById('api-endpoints').style.color = '#6ee7b7';
                
                const now = new Date();
                document.getElementById('last-update').textContent = 'now';
                document.getElementById('last-update').style.color = '#63f8f8';
                
                // Update status badges
                updateStatusBadges(true, true, intData.data_available?.metrics);
                
            } catch (error) {
                console.error('Error loading system data:', error);
                updateStatusBadges(false, false, false);
                
                document.getElementById('cpu').textContent = '‚ö†Ô∏è Error';
                document.getElementById('health-score').textContent = '?';
                document.getElementById('health-score').style.color = '#fca5a5';
            }
        }
        
        // Load data on page load and refresh every 5 seconds
        loadSystemData();
        setInterval(loadSystemData, 5000);
    </script>
</body>
</html>